#include "fft_radix11.h"

#include "fft_common_use.h"

vect_complex_d fft_radix_11(vect_complex_d& f)
{
    int N = f.size();
    vect_complex_d F(N);
    if (N == 11)
    {
        F[0] = f[0] + f[1] + f[2] + f[3] + f[4] + f[5] + f[6] + f[7] + f[8] + f[9] + f[10];
        F[1] = f[0] + complex_d(0.8412535328311812, -0.5406408174555976) * f[1] + complex_d(0.41541501300188644, -0.9096319953545183) * f[2] + complex_d(-0.142314838273285, -0.9898214418809328) * f[3] + complex_d(-0.654860733945285, -0.7557495743542583) * f[4] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[5] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[6] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[7] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[8] + complex_d(0.41541501300188605, 0.9096319953545186) * f[9] + complex_d(0.8412535328311812, 0.5406408174555974) * f[10];
        F[2] = f[0] + complex_d(0.41541501300188644, -0.9096319953545183) * f[1] + complex_d(-0.654860733945285, -0.7557495743542583) * f[2] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[3] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[4] + complex_d(0.8412535328311812, 0.5406408174555974) * f[5] + complex_d(0.8412535328311812, -0.5406408174555976) * f[6] + complex_d(-0.142314838273285, -0.9898214418809328) * f[7] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[8] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[9] + complex_d(0.41541501300188605, 0.9096319953545186) * f[10];
        F[3] = f[0] + complex_d(-0.142314838273285, -0.9898214418809328) * f[1] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[2] + complex_d(0.41541501300188605, 0.9096319953545186) * f[3] + complex_d(0.8412535328311812, -0.5406408174555976) * f[4] + complex_d(-0.654860733945285, -0.7557495743542583) * f[5] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[6] + complex_d(0.8412535328311812, 0.5406408174555974) * f[7] + complex_d(0.41541501300188644, -0.9096319953545183) * f[8] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[9] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[10];
        F[4] = f[0] + complex_d(-0.654860733945285, -0.7557495743542583) * f[1] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[2] + complex_d(0.8412535328311812, -0.5406408174555976) * f[3] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[4] + complex_d(0.41541501300188605, 0.9096319953545186) * f[5] + complex_d(0.41541501300188644, -0.9096319953545183) * f[6] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[7] + complex_d(0.8412535328311812, 0.5406408174555974) * f[8] + complex_d(-0.142314838273285, -0.9898214418809328) * f[9] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[10];
        F[5] = f[0] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[1] + complex_d(0.8412535328311812, 0.5406408174555974) * f[2] + complex_d(-0.654860733945285, -0.7557495743542583) * f[3] + complex_d(0.41541501300188605, 0.9096319953545186) * f[4] + complex_d(-0.142314838273285, -0.9898214418809328) * f[5] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[6] + complex_d(0.41541501300188644, -0.9096319953545183) * f[7] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[8] + complex_d(0.8412535328311812, -0.5406408174555976) * f[9] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[10];
        F[6] = f[0] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[1] + complex_d(0.8412535328311812, -0.5406408174555976) * f[2] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[3] + complex_d(0.41541501300188644, -0.9096319953545183) * f[4] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[5] + complex_d(-0.142314838273285, -0.9898214418809328) * f[6] + complex_d(0.41541501300188605, 0.9096319953545186) * f[7] + complex_d(-0.654860733945285, -0.7557495743542583) * f[8] + complex_d(0.8412535328311812, 0.5406408174555974) * f[9] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[10];
        F[7] = f[0] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[1] + complex_d(-0.142314838273285, -0.9898214418809328) * f[2] + complex_d(0.8412535328311812, 0.5406408174555974) * f[3] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[4] + complex_d(0.41541501300188644, -0.9096319953545183) * f[5] + complex_d(0.41541501300188605, 0.9096319953545186) * f[6] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[7] + complex_d(0.8412535328311812, -0.5406408174555976) * f[8] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[9] + complex_d(-0.654860733945285, -0.7557495743542583) * f[10];
        F[8] = f[0] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[1] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[2] + complex_d(0.41541501300188644, -0.9096319953545183) * f[3] + complex_d(0.8412535328311812, 0.5406408174555974) * f[4] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[5] + complex_d(-0.654860733945285, -0.7557495743542583) * f[6] + complex_d(0.8412535328311812, -0.5406408174555976) * f[7] + complex_d(0.41541501300188605, 0.9096319953545186) * f[8] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[9] + complex_d(-0.142314838273285, -0.9898214418809328) * f[10];
        F[9] = f[0] + complex_d(0.41541501300188605, 0.9096319953545186) * f[1] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[2] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[3] + complex_d(-0.142314838273285, -0.9898214418809328) * f[4] + complex_d(0.8412535328311812, -0.5406408174555976) * f[5] + complex_d(0.8412535328311812, 0.5406408174555974) * f[6] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[7] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[8] + complex_d(-0.654860733945285, -0.7557495743542583) * f[9] + complex_d(0.41541501300188644, -0.9096319953545183) * f[10];
        F[10] = f[0] + complex_d(0.8412535328311812, 0.5406408174555974) * f[1] + complex_d(0.41541501300188605, 0.9096319953545186) * f[2] + complex_d(-0.14231483827328523, 0.9898214418809327) * f[3] + complex_d(-0.6548607339452852, 0.7557495743542582) * f[4] + complex_d(-0.9594929736144975, 0.2817325568414294) * f[5] + complex_d(-0.9594929736144974, -0.28173255684142967) * f[6] + complex_d(-0.654860733945285, -0.7557495743542583) * f[7] + complex_d(-0.142314838273285, -0.9898214418809328) * f[8] + complex_d(0.41541501300188644, -0.9096319953545183) * f[9] + complex_d(0.8412535328311812, -0.5406408174555976) * f[10];
        return F;
    }
    int limit = N / 11;
    vect_complex_d f_1(limit), f_2(limit), f_3(limit),
        f_4(limit), f_5(limit), f_6(limit), f_7(limit),
        f_8(limit), f_9(limit), f_10(limit), f_11(limit);
    for (int r = 0; r < limit; r++)
    {
        f_1[r] = f[11 * r];
        f_2[r] = f[11 * r + 1];
        f_3[r] = f[11 * r + 2];
        f_4[r] = f[11 * r + 3];
        f_5[r] = f[11 * r + 4];
        f_6[r] = f[11 * r + 5];
        f_7[r] = f[11 * r + 6];
        f_8[r] = f[11 * r + 7];
        f_9[r] = f[11 * r + 8];
        f_10[r] = f[11 * r + 9];
        f_11[r] = f[11 * r + 10];
    }
    vect_complex_d F_1, F_2, F_3,
        F_4, F_5, F_6, F_7,
        F_8, F_9, F_10, F_11;
    F_1 = fft_radix_11(f_1);
    F_2 = fft_radix_11(f_2);
    F_3 = fft_radix_11(f_3);
    F_4 = fft_radix_11(f_4);
    F_5 = fft_radix_11(f_5);
    F_6 = fft_radix_11(f_6);
    F_7 = fft_radix_11(f_7);
    F_8 = fft_radix_11(f_8);
    F_9 = fft_radix_11(f_9);
    F_10 = fft_radix_11(f_10);
    F_11 = fft_radix_11(f_11);
    for (int k = 0; k < limit; k++)
    {
        complex_d W1(calculate_W(N, k));
        complex_d W2(calculate_W(N, 2 * k));
        complex_d W3(calculate_W(N, 3 * k));
        complex_d W4(calculate_W(N, 4 * k));
        complex_d W5(calculate_W(N, 5 * k));
        complex_d W6(calculate_W(N, 6 * k));
        complex_d W7(calculate_W(N, 7 * k));
        complex_d W8(calculate_W(N, 8 * k));
        complex_d W9(calculate_W(N, 9 * k));
        complex_d W10(calculate_W(N, 10 * k));
        F[k] = F_1[k] + W1 * F_2[k] + W2 * F_3[k] + W3 * F_4[k] + W4 * F_5[k] + W5 * F_6[k] + W6 * F_7[k] + W7 * F_8[k] + W8 * F_9[k] + W9 * F_10[k] + W10 * F_11[k];
        F[k + limit] = F_1[k] + w11_1 * W1 * F_2[k] + w11_2 * W2 * F_3[k] + w11_3 * W3 * F_4[k] + w11_4 * W4 * F_5[k] + w11_5 * W5 * F_6[k] + w11_6 * W6 * F_7[k] + w11_7 * W7 * F_8[k] + w11_8 * W8 * F_9[k] + w11_9 * W9 * F_10[k] + w11_10 * W10 * F_11[k];
        F[k + 2 * limit] = F_1[k] + w11_2 * W1 * F_2[k] + w11_4 * W2 * F_3[k] + w11_6 * W3 * F_4[k] + w11_8 * W4 * F_5[k] + w11_10 * W5 * F_6[k] + w11_1 * W6 * F_7[k] + w11_3 * W7 * F_8[k] + w11_5 * W8 * F_9[k] + w11_7 * W9 * F_10[k] + w11_9 * W10 * F_11[k];
        F[k + 3 * limit] = F_1[k] + w11_3 * W1 * F_2[k] + w11_6 * W2 * F_3[k] + w11_9 * W3 * F_4[k] + w11_1 * W4 * F_5[k] + w11_4 * W5 * F_6[k] + w11_7 * W6 * F_7[k] + w11_10 * W7 * F_8[k] + w11_2 * W8 * F_9[k] + w11_5 * W9 * F_10[k] + w11_8 * W10 * F_11[k];
        F[k + 4 * limit] = F_1[k] + w11_4 * W1 * F_2[k] + w11_8 * W2 * F_3[k] + w11_1 * W3 * F_4[k] + w11_5 * W4 * F_5[k] + w11_9 * W5 * F_6[k] + w11_2 * W6 * F_7[k] + w11_6 * W7 * F_8[k] + w11_10 * W8 * F_9[k] + w11_3 * W9 * F_10[k] + w11_7 * W10 * F_11[k];
        F[k + 5 * limit] = F_1[k] + w11_5 * W1 * F_2[k] + w11_10 * W2 * F_3[k] + w11_4 * W3 * F_4[k] + w11_9 * W4 * F_5[k] + w11_3 * W5 * F_6[k] + w11_8 * W6 * F_7[k] + w11_2 * W7 * F_8[k] + w11_7 * W8 * F_9[k] + w11_1 * W9 * F_10[k] + w11_6 * W10 * F_11[k];
        F[k + 6 * limit] = F_1[k] + w11_6 * W1 * F_2[k] + w11_1 * W2 * F_3[k] + w11_7 * W3 * F_4[k] + w11_2 * W4 * F_5[k] + w11_8 * W5 * F_6[k] + w11_3 * W6 * F_7[k] + w11_9 * W7 * F_8[k] + w11_4 * W8 * F_9[k] + w11_10 * W9 * F_10[k] + w11_5 * W10 * F_11[k];
        F[k + 7 * limit] = F_1[k] + w11_7 * W1 * F_2[k] + w11_3 * W2 * F_3[k] + w11_10 * W3 * F_4[k] + w11_6 * W4 * F_5[k] + w11_2 * W5 * F_6[k] + w11_9 * W6 * F_7[k] + w11_5 * W7 * F_8[k] + w11_1 * W8 * F_9[k] + w11_8 * W9 * F_10[k] + w11_4 * W10 * F_11[k];
        F[k + 8 * limit] = F_1[k] + w11_8 * W1 * F_2[k] + w11_5 * W2 * F_3[k] + w11_2 * W3 * F_4[k] + w11_10 * W4 * F_5[k] + w11_7 * W5 * F_6[k] + w11_4 * W6 * F_7[k] + w11_1 * W7 * F_8[k] + w11_9 * W8 * F_9[k] + w11_6 * W9 * F_10[k] + w11_3 * W10 * F_11[k];
        F[k + 9 * limit] = F_1[k] + w11_9 * W1 * F_2[k] + w11_7 * W2 * F_3[k] + w11_5 * W3 * F_4[k] + w11_3 * W4 * F_5[k] + w11_1 * W5 * F_6[k] + w11_10 * W6 * F_7[k] + w11_8 * W7 * F_8[k] + w11_6 * W8 * F_9[k] + w11_4 * W9 * F_10[k] + w11_2 * W10 * F_11[k];
        F[k + 10 * limit] = F_1[k] + w11_10 * W1 * F_2[k] + w11_9 * W2 * F_3[k] + w11_8 * W3 * F_4[k] + w11_7 * W4 * F_5[k] + w11_6 * W5 * F_6[k] + w11_5 * W6 * F_7[k] + w11_4 * W7 * F_8[k] + w11_3 * W8 * F_9[k] + w11_2 * W9 * F_10[k] + w11_1 * W10 * F_11[k];
    }
    return F;
}